{"version":3,"sources":["webpack:///./node_modules/js-file-download/file-download.js","webpack:///./src/view/download.vue?7d5b","webpack:///src/view/download.vue","webpack:///./src/view/download.vue?d21f","webpack:///./src/view/download.vue","webpack:///./src/api/pods.js"],"names":["module","exports","data","filename","mime","bom","blobData","blob","Blob","type","window","navigator","msSaveBlob","blobURL","URL","createObjectURL","webkitURL","tempLink","document","createElement","style","display","href","setAttribute","download","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","render","_vm","this","_h","$createElement","_c","_self","attrs","$t","on","selectedNamespace","nativeOn","$event","getNamespace","model","value","callback","$$v","namespace","expression","_l","item","key","_v","selectedPod","pod","label","container","staticStyle","destPath","downloadFile","_s","staticRenderFns","namespaces","pods","containers","methods","res","shell","items","push","metadata","name","console","log","_d","spec","url","xhr","XMLHttpRequest","open","responseType","setRequestHeader","onload","status","content","response","eLink","getResponseHeader","send","component","GetPods","params","get"],"mappings":"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","file":"js/chunk-d6e2ec14.8e11d2b0.js","sourcesContent":["module.exports = function(data, filename, mime, bom) {\n    var blobData = (typeof bom !== 'undefined') ? [bom, data] : [data]\n    var blob = new Blob(blobData, {type: mime || 'application/octet-stream'});\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    }\n    else {\n        var blobURL = (window.URL && window.URL.createObjectURL) ? window.URL.createObjectURL(blob) : window.webkitURL.createObjectURL(blob);\n        var tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n\n        // Fixes \"webkit blob resource error 1\"\n        setTimeout(function() {\n            document.body.removeChild(tempLink);\n            window.URL.revokeObjectURL(blobURL);\n        }, 200)\n    }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',[_c('el-select',{attrs:{\"filterable\":\"\",\"placeholder\":_vm.$t('please_select_namespace')},on:{\"change\":_vm.selectedNamespace},nativeOn:{\"click\":function($event){return _vm.getNamespace($event)}},model:{value:(_vm.namespace),callback:function ($$v) {_vm.namespace=$$v},expression:\"namespace\"}},_vm._l((_vm.namespaces),function(item){return _c('el-option',{key:item,attrs:{\"label\":item,\"value\":item}})}),1),_vm._v(\" \"),_c('el-select',{attrs:{\"placeholder\":_vm.$t('please_select_pod')},on:{\"change\":_vm.selectedPod},model:{value:(_vm.pod),callback:function ($$v) {_vm.pod=$$v},expression:\"pod\"}},_vm._l((_vm.pods),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_vm._v(\" \"),_c('el-select',{attrs:{\"placeholder\":_vm.$t('please_select_container')},model:{value:(_vm.container),callback:function ($$v) {_vm.container=$$v},expression:\"container\"}},_vm._l((_vm.containers),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('div',[_c('el-input',{staticStyle:{\"width\":\"217px\",\"height\":\"40px\"},attrs:{\"autocomplete\":\"off\",\"placeholder\":_vm.$t('please_input_dest_path')},model:{value:(_vm.destPath),callback:function ($$v) {_vm.destPath=$$v},expression:\"destPath\"}})],1),_c('el-button',{nativeOn:{\"click\":function($event){return _vm.downloadFile($event)}}},[_vm._v(_vm._s(_vm.$t('download_file')))])],1),_c('div',{staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},attrs:{\"id\":\"terminal-container\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <el-card shadow=\"never\">\n      <div>\n      <el-select v-model=\"namespace\" @click.native=\"getNamespace\" @change=\"selectedNamespace\" filterable :placeholder=\"$t('please_select_namespace')\">\n        <el-option\n            v-for=\"item in namespaces\"\n            :label=\"item\"\n            :value=\"item\"\n            :key=\"item\"\n        ></el-option>\n      </el-select>\n      &nbsp;&nbsp;\n      <el-select :placeholder=\"$t('please_select_pod')\" v-model=\"pod\" @change=\"selectedPod\">\n        <el-option v-for=\"item in pods\" :label=\"item.label\" :value=\"item.value\" :key=\"item.value\"></el-option>\n      </el-select>\n      &nbsp;&nbsp;\n      <el-select :placeholder=\"$t('please_select_container')\" v-model=\"container\">\n        <el-option v-for=\"item in containers\" :label=\"item.label\" :value=\"item.value\" :key=\"item.value\"></el-option>\n      </el-select>\n      </div>\n      <div>\n      <el-input v-model=\"destPath\" style=\"width: 217px;height: 40px\" autocomplete=\"off\" :placeholder=\"$t('please_input_dest_path')\"></el-input>\n      </div>\n      <el-button @click.native=\"downloadFile\">{{ $t('download_file') }}</el-button>\n    </el-card>\n    <div id=\"terminal-container\" style=\"width: 100%;height: 100%\"></div>\n  </div>\n</template>\n\n<script>\nimport {GetNamespace} from '../api/namespaces'\nimport {GetPods} from \"../api/pods\";\nimport axios from 'axios'\nimport fileDownload from 'js-file-download'\n\nexport default {\n  data() {\n    return {\n      namespace: \"\",\n      pod: \"\",\n      container: \"\",\n      namespaces:[],\n      pods: [],\n      containers:[],\n      destPath:\"\"\n    }\n  },\n  methods: {\n    getNamespace() {\n      GetNamespace().then(res => {\n        if (res) {\n          this.namespaces = []\n          this.pod = \"\"\n          this.pods = []\n          this.container = \"\"\n          this.containers = []\n          this.shell = \"\"\n          const data = res.items;\n          for (const key in data) {\n            this.namespaces.push(data[key].metadata.name)\n          }\n          console.log(this.namespaces)\n        }\n      })\n    },\n    selectedNamespace() {\n      GetPods({namespace: this.namespace}).then(res => {\n        if (res) {\n          const pods = [];\n          this.pod = \"\"\n          this.pods = []\n          this.container = \"\"\n          this.containers = []\n          const data = res.items;\n          for (const key in data) {\n            const _d = {label: data[key].metadata.name, value: data[key].metadata.name};\n            pods.push(_d)\n          }\n          this.pods = pods\n          console.log(this.pods)\n        }\n      })\n    },\n    selectedPod() {\n      GetPods({namespace: this.namespace, pod: this.pod}).then(res => {\n        if (res) {\n          console.log(res)\n          const containers = [];\n          this.container = \"\"\n          this.containers = []\n          const data = res.spec.containers;\n          for (const key in data) {\n            const _d = {label: data[key].name, value: data[key].name};\n            containers.push(_d)\n          }\n          this.containers = containers\n          console.log(this.containers)\n        }\n      })\n    },\n    downloadFile() {\n      const url = \"/api/k8s/download?namespace=\"+this.namespace+\"&pod_name=\"+this.pod+\"&container_name=\"+this.container+\"&dest_path=\"+this.destPath;\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET', url, true);        // 也可以使用POST方式，根据接口\n      xhr.responseType = \"blob\";    // 返回类型blob\n      xhr.setRequestHeader(\"Content-type\", \"application/json;charset=UTF-8\");\n      // 定义请求完成的处理函数，请求前也可以增加加载框/禁用下载按钮逻辑\n      xhr.onload = function () {\n        // 请求完成\n        if (this.status === 200) {\n          // 返回200\n          let content = xhr.response;\n          let eLink = document.createElement('a');\n          eLink.download = this.getResponseHeader('X-File-Name');\n          eLink.style.display = 'none';\n          let blob = new Blob([content]);\n          eLink.href = URL.createObjectURL(blob);\n          document.body.appendChild(eLink);\n          eLink.click();\n          document.body.removeChild(eLink);\n        }\n      };\n      // 发送ajax请求\n      xhr.send()\n    }\n  },\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./download.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./download.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./download.vue?vue&type=template&id=3c163749&\"\nimport script from \"./download.vue?vue&type=script&lang=js&\"\nexport * from \"./download.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {get} from '../lib/fetch.js'\r\n\r\nexport function GetPods(params) {\r\n    return get('/k8s/pods', params)\r\n}"],"sourceRoot":""}