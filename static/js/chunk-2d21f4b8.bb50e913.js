(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21f4b8"],{d8e3:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{attrs:{shadow:"never"}},[a("el-select",{attrs:{filterable:"",placeholder:e.$t("please_select_namespace")},on:{change:e.selectedNamespace},nativeOn:{click:function(t){return e.getNamespace(t)}},model:{value:e.namespace,callback:function(t){e.namespace=t},expression:"namespace"}},e._l(e.namespaces,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),a("el-select",{attrs:{placeholder:e.$t("please_select_deployment"),multiple:""},on:{change:e.selecteddeployment},model:{value:e.deployment,callback:function(t){e.deployment=t},expression:"deployment"}},[a("el-option",{attrs:{label:e.$t("check_all"),value:"all"}}),e._l(e.deployments,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],2),e._v(" "),a("el-button",{nativeOn:{click:function(t){return e.getStatus(t)}}},[e._v(e._s(e.$t("enter")))]),a("br"),a("el-table",{staticClass:"app-table",attrs:{size:"medium",data:e.tableData}},[a("el-table-column",{attrs:{prop:"Pods",label:e.$t("name")}}),a("el-table-column",{attrs:{prop:"Container",label:e.$t("container")}}),a("el-table-column",{attrs:{prop:"Image",label:e.$t("image")}}),a("el-table-column",{attrs:{prop:"Tag",label:e.$t("tag")}}),a("el-table-column",{attrs:{prop:"ImagePullSecrets",label:e.$t("image_pull_secrets")}}),a("el-table-column",{attrs:{prop:"State",label:e.$t("state")}}),a("el-table-column",{attrs:{prop:"CPU",label:e.$t("cpu")}}),a("el-table-column",{attrs:{prop:"RAM",label:e.$t("ram")}}),a("el-table-column",{attrs:{prop:"OS",label:e.$t("os")}}),a("el-table-column",{attrs:{prop:"Operate",label:e.$t("operate"),width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["unix"===t.row.OS?a("el-button",{staticClass:"el-icon-s-fold",nativeOn:{click:function(a){return e.openTerminal(t.row,"sh")}}},[e._v(e._s(e.$t("sh")))]):e._e(),"windows"===t.row.OS?a("el-button",{staticClass:"el-icon-s-fold",nativeOn:{click:function(a){return e.openTerminal(t.row,"cmd")}}},[e._v(e._s(e.$t("cmd")))]):e._e(),a("span"),a("el-button",{staticClass:"el-icon-files",nativeOn:{click:function(a){return e.openFileBrowser(t.row,"/")}}},[e._v(e._s(e.$t("file_browser")))])]}}])})],1)],1),a("el-dialog",{attrs:{width:"80%",title:e.$t("terminal"),visible:e.dialogTerminalVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogTerminalVisible=t},close:function(t){e.dialogTerminalVisible=!1}}},[a("div",[a("span",[e._v("前端实现中")]),a("div",{attrs:{id:"terminal-container"}})])]),a("el-dialog",{attrs:{width:"80%",title:e.$t("file_browser"),visible:e.dialogFileBrowserVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFileBrowserVisible=t},close:function(t){e.dialogFileBrowserVisible=!1}}},[a("el-button",{staticClass:"el-upload el-icon-upload",staticStyle:{"font-size":"16px",float:"right"},attrs:{type:"success",round:""}},[e._v(e._s(e.$t("upload")))]),a("ul",e._l(e.headerPaths,(function(t){return a("li",{staticStyle:{float:"left","margin-right":"5px","list-style":"none"}},[a("a",{staticClass:"el-icon-folder-opened",staticStyle:{"font-size":"16px"},on:{click:function(a){return e.openFileBrowser(null,t.path)}}},[e._v(e._s(t.name))])])})),0),e._v(" "),a("span",{staticClass:"el-icon-refresh",staticStyle:{"font-size":"16px"},on:{click:function(t){return e.openFileBrowser(null,e.path)}}},[e._v(" "+e._s(e.$t("refresh")))]),a("el-table",{staticClass:"app-table",attrs:{size:"100%",data:e.fileBrowserData}},[a("el-header"),a("el-table-column",{attrs:{"min-width":"150px",prop:"Name",label:e.$t("name")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsDir?a("span",{staticClass:"el-icon-folder",on:{click:function(a){return e.openFileBrowser(null,t.row.Path)}}},[e._v(" "+e._s(t.row.Name))]):a("span",{staticClass:"el-icon-files"},[e._v(" "+e._s(t.row.Name))])]}}])}),a("el-table-column",{attrs:{prop:"Size",width:"100px",label:e.$t("size")}}),a("el-table-column",{attrs:{prop:"Mode",width:"100px",label:e.$t("mode")}}),a("el-table-column",{attrs:{prop:"ModTime",label:e.$t("mod_time")}}),a("el-table-column",{attrs:{prop:"Download",label:e.$t("operate"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsDir?a("el-button",{staticClass:"el-icon-upload",staticStyle:{"font-size":"9px"},attrs:{type:"success",round:""}},[e._v(e._s(e.$t("upload")))]):e._e(),a("span"),a("el-dropdown",{staticClass:"avatar-container",attrs:{type:"primary",trigger:"click"}},[a("div",{staticClass:"avatar-wrapper"},[a("el-button",{staticClass:"el-icon-download",attrs:{type:"primary",round:"",size:"medium"}},[e._v(" "+e._s(e.$t("download"))+" "),a("i",{staticClass:"el-icon-caret-bottom"})])],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("span",{staticStyle:{display:"block"},on:{click:function(a){return e.download(t.row.Path,"tar")}}},[e._v("TAR"+e._s(e.$t("download")))])]),a("el-dropdown-item",{attrs:{divided:""}},[a("span",{staticStyle:{display:"block"},on:{click:function(a){return e.download(t.row.Path,"zip")}}},[e._v("ZIP"+e._s(e.$t("download")))])])],1)],1)]}}])})],1)],1)],1)},s=[],o=a("ead3");function n(e){return Object(o["a"])("/k8s/status",e)}var i=a("1764");function r(e){return Object(o["a"])("/k8s/deployment",e)}function c(e){return Object(o["a"])("/k8s/file_browser",e)}var p={data(){return{namespace:"",deployment:[],namespaces:[],tableLoading:!1,tableData:[],deployments:[],fileBrowserData:[],pods:"",container:"",path:"",headerPaths:[],dialogTerminalVisible:!1,dialogFileBrowserVisible:!1}},methods:{getNamespace(){Object(i["a"])().then(e=>{if(e){this.namespaces=[],this.deployment=[],this.deployments=[],this.tableData=[];const t=e.items;for(const e in t)this.namespaces.push(t[e].metadata.name);console.log(this.namespaces)}})},selectedNamespace(e){console.log(e),r({namespace:e}).then(e=>{if(e){const t=[];this.deployments=[],this.tableData=[];const a=e.items;for(const e in a){const l={label:a[e].metadata.name,value:a[e].metadata.name};t.push(l)}this.deployments=t,console.log(this.deployments)}})},selecteddeployment(e){console.log(e)},getStatus(){console.log(this.deployment[0],this.namespace);let e=this.deployment;if("all"===this.deployment[0]){e=[];for(const t in this.deployments)e.push(this.deployments[t].value)}n({namespace:this.namespace,deployment:e}).then(e=>{if(e){console.log(e),this.tableData=[];for(const t in e){const a=e[t].pod_name,l=e[t].containers;for(const e in l){let t={Pods:"",Container:l[e].name,Image:l[e].image,Tag:l[e].version,ImagePullSecrets:l[e].image_pull_policy,State:l[e].state,CPU:l[e].cpu,RAM:l[e].ram,OS:l[e].os};"0"===e&&(t={Pods:a,Container:l[e].name,Image:l[e].image,Tag:l[e].version,ImagePullSecrets:l[e].image_pull_policy,State:l[e].state,CPU:l[e].cpu,RAM:l[e].ram,OS:l[e].os}),this.tableData.push(t)}}}})},openTerminal(e,t){this.dialogTerminalVisible=!0,console.log(e,this.namespace,t)},openFileBrowser(e,t){if(this.dialogFileBrowserVisible=!0,console.log(e,t),void 0===t&&(t="/"),"/"===t&&null!==e&&(this.pods=e.Pods,this.container=e.Container),this.headerPaths=[],this.headerPaths.push(t),void 0!==t){let e=t.split("/"),a="";this.headerPaths=[],e.forEach((e,t)=>{console.log(t,e),0===t&&(a="/",e="/",this.headerPaths.push({name:e,path:a})),0!==t&&""!==e&&(a+=e+"/",this.headerPaths.push({name:e,path:a}))})}console.log(this.headerPaths),this.path=t,this.fileBrowserData=[],c({namespace:this.namespace,pods:this.pods,container:this.container,path:t}).then(e=>{console.log(e),this.fileBrowserData=[],void 0!==e&&(this.fileBrowserData=e)},e=>{console.log(e),alert(e.info.message)})},download(e,t){const a="/api/k8s/download?namespace="+this.namespace+"&pod_name="+this.pods+"&container_name="+this.container+"&dest_path="+e+"&style="+t,l=new XMLHttpRequest;l.open("GET",a,!0),l.responseType="blob",l.setRequestHeader("Content-type","application/json;charset=UTF-8"),l.onload=function(){if(200===this.status){let e=l.response,t=document.createElement("a");t.download=this.getResponseHeader("X-File-Name"),t.style.display="none";let a=new Blob([e]);t.href=URL.createObjectURL(a),document.body.appendChild(t),t.click(),document.body.removeChild(t)}},l.send()},handleClose(e){this.$confirm("确认关闭？").then(t=>{e()}).catch(e=>{})}},watch:{deployment:function(e,t){let a=e.indexOf("all"),l=t.indexOf("all");-1!==a&&-1===l&&e.length>1?this.deployment=["all"]:-1!==a&&-1!==l&&e.length>1&&this.deployment.splice(e.indexOf("all"),1)}}},d=p,u=a("2877"),m=Object(u["a"])(d,l,s,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d21f4b8.bb50e913.js.map